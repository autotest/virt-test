- flag_check:
    virt_test_type = qemu
    # this case work on other guest as well, but some flags is not recognized by old kernel
    # test only on one guest is acceptable for flag check
    only RHEL.6
    type = flag_check
    # option_flags are generated by kernel or kvm
    option_flags = "rep_good unfair_spinlock extd_apicid hypervisor"
    #out_flags are flags not in guest
    #dont support rdtscp because bug 814426
    #dont support svm|vmx according to bug 869991#c2
    out_flags = "rdtscp svm vmx"
    # remove lahf_lm from Opteron_G1,G2,G3 dumpfile because of bug 871265#c2
    # need to add sep to dumpfile while bug 821741 is fixed
    dump_file = "cpuid_dump.txt"
    # use dump_path when you try to download dump file from internet
    # dump_path = "/tmp"
    pattern = r"flags:\s+f_edx:(.*)\s+f_ecx:(.*)\s+extf_edx:(.*)\s+extf_ecx(.*)"
    variants:
        - basic:
        - lack_flag_check:
            #x2apic is emulated by qemu-kvm, no need to
            #check if it lacks in host
            out_flags += " x2apic"
            variants:
                - unknown_flag:
                    cpu_model_flags = ",+unknown,check"
                - unsupported_flags:
                    cpu_model_flags = ",+sse4a,+aes,+ssse3,+sse4.2,check"
                - cpuid_7_0_ebx_feature:
                    cpu_model_flags = ",+fsgsbase,check"
