- svirt_attach_disk:
    virt_test_type = libvirt
    type = svirt_attach_disk
    start_vm = no
    kill_vm = yes
    kill_vm_gracefully = yes
    kill_vm_on_error = yes
    shutdown_cleanly = yes
    sec_label = system_u:system_r:svirt_t:s0:c87,c520
    variants:
        - host_selinux_enforcing:
            host_selinux = enforcing
        - host_selinux_permissive:
            host_selinux = permissive
    variants:
        - sec_type_dynamic:
            sec_type = dynamic
        - sec_type_static:
            sec_type = static
    variants:
        - sec_relabel_no:
            only sec_type_static
            sec_relabel = no
        - sec_relabel_yes:
            sec_relabel = yes
    variants:
        - img_label_virt_content:
            img_label = system_u:object_r:virt_content_t:s0
        - disk_label_svirt_image_s0:
            img_label = system_u:object_r:svirt_image_t:s0
        - disk_label_svirt_image_MCS1:
            img_label = system_u:object_r:svirt_image_t:s0:c87,c520
    variants:
        - positive_test:
            status_error = no
            no host_selinux_enforcing..sec_relabel_no..img_label_virt_content
        - negative_test:
            #only when selinux is enforcing and
            #seclabel of VM is not relabeled and
            #img is labeld by "system_u:object_r:virt_content_t:s0",
            #VM will not be able to access image.
            status_error = yes
            only host_selinux_enforcing..sec_relabel_no..img_label_virt_content
